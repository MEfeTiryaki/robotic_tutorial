<?xml version="1.0" encoding="utf-8"?>

<launch>

  <!-- ROBOT SPECIFIC ARGUMENTS -->
  <!-- Robot description name -->
  <arg name="robot_description"                        default="gopigo"/>

  <!-- ROBOT ID -->
  <arg name="robot_id"                                  default="0001"/>

  <!-- Set the name of the robot -->
  <arg name="robot_name"                                default="$(arg robot_description)_$(arg robot_id)"/>

  <!-- Set robot description path -->
  <arg name="description_file"                          default="$(find ridgeback_description)/urdf/ridgeback.urdf.xacro"/>

  <!-- PARAMETERS -->
  <!-- Set global simulation parameter -->
  <arg name="simulation"                                default="false"/>
  <arg name="debug"                                     default="false"/>


  <!-- GAZEBO ARGUMENTS -->

  <!-- Run Gazebo headless -->
  <arg name="gazebo_headless"                           default="false"/>

  <!-- Model path -->
  <!-- If the world is not found in a "linked" devel space layout (see catkin config), this might help: -->
  <arg name="model_path"                                default="$(find cri_efe_gazebo)/.."/>


  <!-- WORLD MAP -->
  <!--arg name="world"                                     default="empty"/-->
  <arg name="world"                                     default="empty"/>
  <!-- Path to the world file -->
  <arg name="world_file"                                default="$(find cri_efe_description)/worlds/$(arg world).world"/>

  <!-- Set true to fix the cri_efe's main body in space -->
  <arg name="fixed"                                     default="false"/>

  <!-- Set the initial pose of the robot's main body -->
  <arg name="x"                                         default="0.0"/>
  <arg name="y"                                         default="0.0"/>
  <arg name="z"                                         default="0.0"/>
  <arg name="roll"                                      default="0.0"/>
  <arg name="pitch"                                     default="0.0"/>
  <arg name="yaw"                                       default="0.0"/>

  <!-- Frame offsets -->
  <arg name="frame_odometry_offset_x"                   default="0.0"/>
  <arg name="frame_odometry_offset_y"                   default="0.0"/>
  <arg name="frame_odometry_offset_z"                   default="0.0"/>



  <!-- GUI ARGUMENTS -->
  <!-- Enable/disable Gazebo GUI -->
  <arg name="run_gazebo_gui"                            default="false"/>
  <!-- Enable/disable rviz -->
  <arg name="run_rviz"                                  default="true"/>
  <!-- rviz configuration -->
  <arg name="rviz_config_path"                          default="$(find cri_efe_sim)/config/rviz/cri_efe_real.rviz"/>
  <!-- Path to the RViz world -->
  <arg name="rviz_world_path"                           default="$(find cri_efe_gazebo)/rviz/$(arg world).yaml"/>


  <!-- TF PARAMETERS -->
  <!-- tf prefix -->
  <arg name="tf_prefix"                                 default=""/>
  <!-- tf minimal -->
  <arg name="tf_minimal"                                default="false"/>


  <rosparam command="load"  ns="" file="$(find cri_efe_sim)/config/parameters_real.yaml"/>



  <!-- GAZEBO -->
  <include file="$(find cri_efe_gazebo)/launch/gazebo.launch">
    <arg name="use_sim_time"      value="false"/>
    <arg name="gui"               value="$(arg run_gazebo_gui)"/>
    <arg name="world_name"        value="$(arg world_file)"/>
    <arg name="verbose"           value="true"/>
    <arg name="simulation"        value="$(arg simulation)"/>
    <arg name="robot_name"        value="$(arg robot_name)"/>
  </include>

  <!-- RVIZ -->
  <group if="$(arg run_rviz)">
    <include file="$(find cri_efe_description)/launch/rviz/rviz.launch">
      <arg name="rviz_config_path"          value="$(arg rviz_config_path)"/>
      <arg name="rviz_world_path"           value="$(arg rviz_world_path)"/>
      <arg name="tf_minimal"                value="$(arg tf_minimal)"/>
    </include>
  </group>

  <include file="$(find cri_efe_description)/launch/modules/marker_plate.launch">
    <arg name="id" value="0"/>
  </include>
  <include file="$(find cri_efe_description)/launch/modules/marker_plate.launch">
    <arg name="id" value="1"/>
  </include>
  <include file="$(find cri_efe_description)/launch/modules/marker_plate.launch">
    <arg name="id" value="2"/>
  </include>
  <include file="$(find cri_efe_description)/launch/modules/marker_plate.launch">
    <arg name="id" value="3"/>
  </include>
  <include file="$(find cri_efe_description)/launch/modules/marker_plate.launch">
    <arg name="id" value="4"/>
  </include>
  <include file="$(find cri_efe_description)/launch/modules/marker_plate.launch">
    <arg name="id" value="5"/>
  </include>

  <!-- ROBOTS -->
  <include file="$(find cri_efe_description)/launch/gopigo.launch">
    <arg name="robot_namespace"    value="gopigo_0001"/>
    <arg name="simulation"    value="$(arg simulation)"/>
    <arg name="debug"         value="$(arg debug)"/>
    <arg name="camera_name"    value="kinect2/hd"/>
    <arg name="camera_frame"    value="camera_link_rgb_optical_frame"/>
    <arg name="image_name"    value="image_color"/>
    <arg name="x"         value="0.0"/>
    <arg name="y"         value="0.0"/>
    <arg name="z"         value="0.05"/>
  </include>

  <!-- MOTION CAPTURE
  <include file="$(find optitrack)/launch/optitrack_pipeline.launch">
    <arg name="iface"         value="enp0s31f6"/>
  </include>
 -->
  <!-- TF publisher -->
  <include file="$(find cri_efe_tf)/launch/tf_publisher.launch">
    <arg name="simulation"          value="$(arg simulation)"/>
  </include>

  <!-- Rqt GuI -->
  <node pkg="rqt_gui" type="rqt_gui" name="rqt_gui" output="screen"  args="-p cri_rqt">
    <param name="simulation" value="$(arg simulation)"/>
  </node>

</launch>
